{% extends "__layout_sidebar_left.html" %}
{% load static %}
{% load i18n %}
{% load cloudinary %}

{% load account socialaccount %}

{% block col-side %}
    {% if user.profile.third_party_login %}
        //TODO: create a method that returns profile pic in model
        <img src="{{ user.socialaccount_set.all.0.get_avatar_url }}" />
    {% else %}
        {% cloudinary request.user.profile.profile_picture format="jpg" width=250 height=250 crop="fill" %}
    {% endif %}
{% endblock col-side %}

{% block col-main %}
    <div>
        <h3>
            {{ user.profile.display_name }}
        </h3>
        <p>{{ user.profile.user.email }}</p>
        <p>Last login: {{ user.profile.user.last_login }}</p>
        <p>
            <small>
                <a href="{% url 'profile:user-profile-update' %}" class="button success">{% trans 'Update profile' %}</a>
            </small>
            <small>
                <a id="game_new" href="{% url 'profile:create-api-key' %}" class="button">New API Key</a>
            </small>
        </p>
        {%  if request.user.profile.is_developer %}
            {% if request.user.profile.api_tokens.all %}
                <h4>API Keys</h4>
            {% endif %}
            <ul>
            {% for api_token in request.user.profile.api_tokens.all %}
                <li><b>{{ api_token.token }}</b> - {{ api_token.website_url }}</li>
            {% endfor %}
            </ul>

        {% endif %}
    </div>
{% endblock col-main %}